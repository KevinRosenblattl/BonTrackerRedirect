<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Opening App...</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 50px;
        }
    </style>
</head>
<body>
    <h1>Opening App...</h1>
    <p>If the app doesn't open automatically, please open it manually.</p>
    
    <script>
        // Hole Token aus URL - Supabase verwendet # statt ?
        const hashParams = new URLSearchParams(window.location.hash.substring(1));
        const searchParams = new URLSearchParams(window.location.search);
        
        // Token kann in hash oder search params sein
        const token = hashParams.get('access_token') || searchParams.get('token');
        const type = hashParams.get('type') || searchParams.get('type') || 'recovery';
        
        console.log('Token:', token); // Zum Debuggen
        console.log('Full URL:', window.location.href); // Zum Debuggen
        
        // Versuche App zu öffnen
        if (token) {
            const deepLink = `ocrtesting://reset-password?token=${token}&type=${type}`;
            console.log('Opening:', deepLink);
            window.location = deepLink;
        } else {
            document.body.innerHTML = '<h1>❌ No token found</h1><p>URL: ' + window.location.href + '</p>';
        }
        
        // Fallback nach 3 Sekunden
        setTimeout(() => {
            document.body.innerHTML += '<br><p>Please open the app manually to complete password reset.</p>';
        }, 3000);
    </script>
</body>
</html>
